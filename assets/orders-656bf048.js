import{j as e,v as K,T as S,P as r,B as V,w as X,x as G,I as J,y as Q,r as i,z as Y,A as Z,S as ee,h as te,C as ne,W as re}from"./index-58ea0f34.js";import{T as j,a as l,b as ae,c as se,s as oe,d as ie,e as ce,f as le,g as de}from"./search-fill-3b0d23cc.js";import{L as ue}from"./label-34ca8f52.js";import{O as he}from"./Select-73143bba.js";import{C as xe}from"./Container-c52c4247.js";import{C as me}from"./Card-8f4d38d7.js";import{u as pe}from"./use-auth-8f151975.js";import"./Menu-6b3eeb48.js";const fe={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function ge(t,s,o){return t?Math.max(0,(1+t)*s-o):0}function N({query:t}){return e.jsx(j,{children:e.jsx(l,{align:"center",colSpan:6,sx:{py:3},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(S,{variant:"h6",paragraph:!0,children:"Not found"}),e.jsxs(S,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',t,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}N.propTypes={query:r.string};function A({name:t,customer:s,create_date:o,amount_untaxed:d,amount_tax:h,amount_total:a,state:x,handleClick:R}){const p=b=>`$${b.toFixed(2)}`;return e.jsxs(j,{hover:!0,tabIndex:-1,children:[e.jsx(l,{children:t}),e.jsx(l,{children:s}),e.jsx(l,{children:o}),e.jsx(l,{children:p(d)}),e.jsx(l,{children:p(h)}),e.jsx(l,{children:p(a)}),e.jsx(l,{children:e.jsx(ue,{color:x!=="draft"&&"error"||"success",children:x})})]})}A.propTypes={name:r.any,customer:r.any,create_date:r.any,amount_untaxed:r.any,amount_tax:r.any,amount_total:r.any,state:r.any,handleClick:r.func};function k({order:t,orderBy:s,headLabel:o,onRequestSort:d}){const h=a=>x=>{d(x,a)};return e.jsx(ae,{children:e.jsx(j,{children:o.map(a=>e.jsx(l,{align:a.align||"left",sortDirection:s===a.id?t:!1,sx:{width:a.width,minWidth:a.minWidth},children:e.jsxs(se,{hideSortIcon:!0,active:s===a.id,direction:s===a.id?t:"desc",onClick:h(a.id),children:[a.label,s===a.id?e.jsx(V,{sx:{...fe},children:t==="desc"?"sorted descending":"sorted ascending"}):null]})},a.id))})})}k.propTypes={order:r.oneOf(["asc","desc"]),orderBy:r.string,headLabel:r.array,onRequestSort:r.func};function E({emptyRows:t,height:s}){return t?e.jsx(j,{sx:{...s&&{height:s*t}},children:e.jsx(l,{colSpan:9})}):null}E.propTypes={emptyRows:r.number,height:r.number};function F({filterName:t,onFilterName:s,onClickSearch:o,onHitEnter:d}){return e.jsx(X,{sx:{height:96,display:"flex",justifyContent:"space-between",p:h=>h.spacing(0,1,0,3)},children:e.jsx(he,{value:t,onChange:s,onKeyDown:d,placeholder:"Search order...",endAdornment:e.jsx(G,{position:"end",children:e.jsx(J,{onClick:o,edge:"end",children:e.jsx(Q,{icon:oe,sx:{color:"text.disabled",width:20,height:20}})})})})})}F.propTypes={filterName:r.string,onFilterName:r.func,onClickSearch:r.func,onHitEnter:r.func};function je(){const[t,s]=i.useState([]),[o,d]=i.useState(0),[h,a]=i.useState(0),[x,R]=i.useState("asc"),[p,b]=i.useState("name"),[m,I]=i.useState(""),[c,B]=i.useState(25),[$,L]=i.useState(0),w=i.useRef(t),O=i.useRef(c),P=i.useRef(o),_=i.useRef(m);i.useEffect(()=>{w.current=t,O.current=c,P.current=o,_.current=m,y(P.current,O.current,w.current,_.current)},[]);const y=(n,u,f,v)=>{console.log("Fetching Orders");const M=n+1;let T=`${ne.baseURL}/api-proxy/proxy?method=get&resource=orders&page=${M}&page_size=${u}`;v&&(T+=`&name=${v}`),console.log(T),Y.get(T,{headers:{Authorization:`Bearer ${Z.get("jwt")}`}}).then(g=>{console.log(g.data.data),s([...f,...g.data.data]),L(g.data.count)}).catch(g=>{console.error("Error fetching orders:",g)})},q=(n,u)=>{u!==""&&(R(p===u&&x==="asc"?"desc":"asc"),b(u))},D=(n,u)=>{d(u);const f=c*u;f>h&&(a(f),y(u,c,t,m))},H=n=>{d(0),B(parseInt(n.target.value,10))},z=n=>{I(n.target.value)},W=n=>{n.key==="Enter"&&C()},C=n=>{d(0),y(o,c,[],m)},U=!t.length&&!!m;return e.jsxs(xe,{children:[e.jsx(ee,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:e.jsx(S,{variant:"h4",children:"Orders"})}),e.jsxs(me,{children:[e.jsx(F,{filterName:m,onFilterName:z,onClickSearch:C,onHitEnter:W}),e.jsx(te,{children:e.jsx(ie,{sx:{overflow:"unset"},children:e.jsxs(ce,{sx:{minWidth:800},children:[e.jsx(k,{order:x,orderBy:p,rowCount:t.length,onRequestSort:q,headLabel:[{id:"name",label:"Name"},{id:"customer",label:"Customer"},{id:"create_date",label:"Create Date"},{id:"amount_untaxed",label:"Amount Untaxed"},{id:"amount_tax",label:"Amount Tax"},{id:"amount_total",label:"Amount Total"},{id:"state",label:"State"}]}),e.jsxs(le,{children:[t.slice(o*c,o*c+c).map(n=>e.jsx(A,{name:n.name,customer:n.customer_id.name,create_date:n.create_date,amount_untaxed:n.amount_untaxed,amount_tax:n.amount_tax,amount_total:n.amount_total,state:n.state},n.id)),e.jsx(E,{height:77,emptyRows:ge(o,c,t.length)}),U&&e.jsx(N,{query:m})]})]})})}),e.jsx(de,{page:o,component:"div",count:$,rowsPerPage:c,onPageChange:D,rowsPerPageOptions:[25],onRowsPerPageChange:H})]})]})}function _e(){return pe(),e.jsxs(e.Fragment,{children:[e.jsx(re,{children:e.jsx("title",{children:" Order | BEX Sales "})}),e.jsx(je,{})]})}export{_e as default};
