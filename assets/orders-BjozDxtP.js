import{j as e,H as te,T as k,P as n,B as ne,J as re,S as O,I as ae,D as se,K as oe,w as ie,r as o,y as ce,z as le,M as de,A as ue,W as he}from"./index-B8l5MPOb.js";import{T as y,a as i,b as xe,c as me,s as pe,d as ge,e as fe,f as be,g as je}from"./search-fill-BqqYaOZF.js";import{L as _e}from"./label-nOTOM0zL.js";import{C as L,F as ye}from"./FormControlLabel-D6pUkteO.js";import{O as Se}from"./Select-CETdWe22.js";import{C as Te}from"./CircularProgress-j2gw31bc.js";import{C as Ce}from"./Container-57NIevnF.js";import{C as Pe}from"./Card-DExzLAxj.js";import{u as ve}from"./use-auth-DsvEjS1e.js";const Re={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function ke(a,s,u){return a?Math.max(0,(1+a)*s-u):0}function B({query:a}){return e.jsx(y,{children:e.jsx(i,{align:"center",colSpan:6,sx:{py:3},children:e.jsxs(te,{sx:{textAlign:"center"},children:[e.jsx(k,{variant:"h6",paragraph:!0,children:"Not found"}),e.jsxs(k,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',a,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}B.propTypes={query:n.string};function D({name:a,customer:s,create_date:u,amount_untaxed:c,amount_tax:m,amount_total:r,state:h,invoiced:S,x_studio_notes:T,client_order_ref:b,ship_date:C,ship_tracking_number:j,handleClick:P}){const d=v=>`$${v.toFixed(2)}`;return e.jsxs(y,{hover:!0,tabIndex:-1,onClick:P,children:[e.jsx(i,{children:a}),e.jsx(i,{children:s}),e.jsx(i,{children:u}),e.jsx(i,{children:d(c)}),e.jsx(i,{children:d(m)}),e.jsx(i,{children:d(r)}),e.jsx(i,{children:e.jsx(_e,{color:h!=="draft"&&"error"||"success",children:h})}),e.jsx(i,{align:"center",children:e.jsx(L,{checked:S,disabled:!0})}),e.jsx(i,{children:T}),e.jsx(i,{children:b}),e.jsx(i,{children:C}),e.jsx(i,{children:j})]})}D.propTypes={name:n.any,customer:n.any,create_date:n.any,amount_untaxed:n.any,amount_tax:n.any,amount_total:n.any,state:n.any,invoiced:n.bool,x_studio_notes:n.any,client_order_ref:n.any,ship_date:n.any,ship_tracking_number:n.any,handleClick:n.func};function H({order:a,orderBy:s,headLabel:u,onRequestSort:c}){const m=r=>h=>{c(h,r)};return e.jsx(xe,{children:e.jsx(y,{children:u.map(r=>e.jsx(i,{align:r.align||"left",sortDirection:s===r.id?a:!1,sx:{width:r.width,minWidth:r.minWidth},children:e.jsxs(me,{hideSortIcon:!0,active:s===r.id,direction:s===r.id?a:"desc",onClick:m(r.id),children:[r.label,s===r.id?e.jsx(ne,{sx:{...Re},children:a==="desc"?"sorted descending":"sorted ascending"}):null]})},r.id))})})}H.propTypes={order:n.oneOf(["asc","desc"]),orderBy:n.string,headLabel:n.array,onRequestSort:n.func};function q({emptyRows:a,height:s}){return a?e.jsx(y,{sx:{...s&&{height:s*a}},children:e.jsx(i,{colSpan:9})}):null}q.propTypes={emptyRows:n.number,height:n.number};function z({filterName:a,onFilterName:s,onClickSearch:u,onHitEnter:c,isPartnerSearch:m,onTogglePartnerSearch:r}){return e.jsx(re,{sx:{height:96,display:"flex",justifyContent:"space-between",p:h=>h.spacing(0,1,0,3)},children:e.jsxs(O,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(Se,{value:a,onChange:s,onKeyDown:c,placeholder:m?"Search by partner...":"Search order...",endAdornment:e.jsx(ae,{position:"end",children:e.jsx(se,{onClick:u,edge:"end",children:e.jsx(oe,{icon:pe,style:{color:"text.disabled",width:20,height:20}})})})}),e.jsx(ye,{control:e.jsx(L,{checked:m,onChange:r,color:"primary"}),label:"Search by Partner"})]})})}z.propTypes={filterName:n.string,onFilterName:n.func,onClickSearch:n.func,onHitEnter:n.func,isPartnerSearch:n.bool,onTogglePartnerSearch:n.func};function Oe(){const a=ie(),[s,u]=o.useState(!1),[c,m]=o.useState([]),[r,h]=o.useState(0),[S,T]=o.useState(0),[b,C]=o.useState("asc"),[j,P]=o.useState("name"),[d,v]=o.useState(""),[p,W]=o.useState(!1),[x,M]=o.useState(25),[U,K]=o.useState(0),w=o.useRef(c),I=o.useRef(x),N=o.useRef(r),F=o.useRef(d);o.useEffect(()=>{w.current=c,I.current=x,N.current=r,F.current=d,R(N.current,I.current,w.current,F.current,p)},[]);const R=(t,l,g,E,$)=>{console.log("Fetching Orders"),u(!0);const ee=t+1;let _=`${ue.baseURL}/api-proxy/proxy?method=get&resource=orders&page=${ee}&page_size=${l}`;E&&(_+=`&name=${E}`),$&&(_+=`&search_partner=${$}`),console.log(_),ce.get(_,{headers:{Authorization:`Bearer ${le.get("jwt")}`}}).then(f=>{console.log(f.data.data),m([...g,...f.data.data]),K(f.data.count)}).catch(f=>{console.error("Error fetching orders:",f)}).finally(()=>{u(!1)})},J=(t,l)=>{l!==""&&(C(j===l&&b==="asc"?"desc":"asc"),P(l))},V=(t,l)=>{h(l);const g=x*l;window.scrollTo({top:0,behavior:"smooth"}),g>S&&(T(g),R(l,x,c,d,p))},X=t=>{h(0),M(parseInt(t.target.value,10))},G=t=>{v(t.target.value)},Q=t=>{t.key==="Enter"&&A()},A=t=>{h(0),R(r,x,[],d,p)},Y=(t,l)=>{a.push(`/orders/${l}`)},Z=!c.length&&!!d;return e.jsxs(e.Fragment,{children:[s&&e.jsx(O,{sx:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",bgcolor:"rgba(255, 255, 255, 0.6)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Te,{})}),e.jsxs(Ce,{children:[e.jsx(O,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:e.jsx(k,{variant:"h4",children:"Orders"})}),e.jsxs(Pe,{children:[e.jsx(z,{filterName:d,onFilterName:G,onClickSearch:A,onHitEnter:Q,isPartnerSearch:p,onTogglePartnerSearch:()=>W(!p)}),e.jsx(de,{children:e.jsx(ge,{sx:{overflow:"unset"},children:e.jsxs(fe,{sx:{minWidth:800},children:[e.jsx(H,{order:b,orderBy:j,rowCount:c.length,onRequestSort:J,headLabel:[{id:"name",label:"Name"},{id:"customer",label:"Customer"},{id:"create_date",label:"Create Date"},{id:"amount_untaxed",label:"Amount Untaxed"},{id:"amount_tax",label:"Amount Tax"},{id:"amount_total",label:"Amount Total"},{id:"state",label:"State"},{id:"invoiced",label:"Invoiced"},{id:"x_studio_notes",label:"Notes"},{id:"client_order_ref",label:"PO Number"},{id:"ship_date",label:"Ship Date"},{id:"ship_tracking_number",label:"Tracking #"}]}),e.jsxs(be,{children:[c.slice(r*x,r*x+x).map(t=>e.jsx(D,{name:t.name,customer:t.customer_id.name,create_date:t.create_date,amount_untaxed:t.amount_untaxed,amount_tax:t.amount_tax,amount_total:t.amount_total,state:t.state,invoiced:t.account_move_count>0,x_studio_notes:t.x_studio_notes,client_order_ref:t.client_order_ref,ship_date:t.ship_date,ship_tracking_number:t.ship_tracking_number,handleClick:l=>Y(l,t.id)},t.id)),e.jsx(q,{height:77,emptyRows:ke(r,x,c.length)}),Z&&e.jsx(B,{query:d})]})]})})}),e.jsx(je,{page:r,component:"div",count:U,rowsPerPage:x,onPageChange:V,rowsPerPageOptions:[25],onRowsPerPageChange:X})]})]})]})}function De(){return ve(),e.jsxs(e.Fragment,{children:[e.jsx(he,{children:e.jsx("title",{children:" Order | BEX Sales "})}),e.jsx(Oe,{})]})}export{De as default};
