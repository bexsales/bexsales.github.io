import{j as e,n as X,T as R,P as r,B as G,o as J,I as Q,q as Y,t as Z,z as ee,r as i,v as te,w as ne,S as re,x as ae,y as se,W as oe}from"./index-5e826625.js";import{T as y,a as d,b as ce,c as ie,s as le,d as de,e as ue,f as he,g as xe}from"./search-fill-e30a7fa5.js";import{L as me}from"./label-7c44723c.js";import{O as pe}from"./Select-095a4346.js";import{C as fe}from"./Container-5a53d79a.js";import{C as ge}from"./Card-f78012bd.js";import{u as je}from"./use-auth-dbbc2bf8.js";import"./Menu-ab44c921.js";const be={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function ye(a,t,u){return a?Math.max(0,(1+a)*t-u):0}function k({query:a}){return e.jsx(y,{children:e.jsx(d,{align:"center",colSpan:6,sx:{py:3},children:e.jsxs(X,{sx:{textAlign:"center"},children:[e.jsx(R,{variant:"h6",paragraph:!0,children:"Not found"}),e.jsxs(R,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',a,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}k.propTypes={query:r.string};function N({name:a,customer:t,create_date:u,amount_untaxed:o,amount_tax:h,amount_total:s,state:m,handleClick:j}){const p=b=>`$${b.toFixed(2)}`;return e.jsxs(y,{hover:!0,tabIndex:-1,onClick:j,children:[e.jsx(d,{children:a}),e.jsx(d,{children:t}),e.jsx(d,{children:u}),e.jsx(d,{children:p(o)}),e.jsx(d,{children:p(h)}),e.jsx(d,{children:p(s)}),e.jsx(d,{children:e.jsx(me,{color:m!=="draft"&&"error"||"success",children:m})})]})}N.propTypes={name:r.any,customer:r.any,create_date:r.any,amount_untaxed:r.any,amount_tax:r.any,amount_total:r.any,state:r.any,handleClick:r.func};function A({order:a,orderBy:t,headLabel:u,onRequestSort:o}){const h=s=>m=>{o(m,s)};return e.jsx(ce,{children:e.jsx(y,{children:u.map(s=>e.jsx(d,{align:s.align||"left",sortDirection:t===s.id?a:!1,sx:{width:s.width,minWidth:s.minWidth},children:e.jsxs(ie,{hideSortIcon:!0,active:t===s.id,direction:t===s.id?a:"desc",onClick:h(s.id),children:[s.label,t===s.id?e.jsx(G,{sx:{...be},children:a==="desc"?"sorted descending":"sorted ascending"}):null]})},s.id))})})}A.propTypes={order:r.oneOf(["asc","desc"]),orderBy:r.string,headLabel:r.array,onRequestSort:r.func};function E({emptyRows:a,height:t}){return a?e.jsx(y,{sx:{...t&&{height:t*a}},children:e.jsx(d,{colSpan:9})}):null}E.propTypes={emptyRows:r.number,height:r.number};function F({filterName:a,onFilterName:t,onClickSearch:u,onHitEnter:o}){return e.jsx(J,{sx:{height:96,display:"flex",justifyContent:"space-between",p:h=>h.spacing(0,1,0,3)},children:e.jsx(pe,{value:a,onChange:t,onKeyDown:o,placeholder:"Search order...",endAdornment:e.jsx(Q,{position:"end",children:e.jsx(Y,{onClick:u,edge:"end",children:e.jsx(Z,{icon:le,sx:{color:"text.disabled",width:20,height:20}})})})})})}F.propTypes={filterName:r.string,onFilterName:r.func,onClickSearch:r.func,onHitEnter:r.func};function Te(){const a=ee(),[t,u]=i.useState([]),[o,h]=i.useState(0),[s,m]=i.useState(0),[j,p]=i.useState("asc"),[b,I]=i.useState("name"),[x,$]=i.useState(""),[l,B]=i.useState(25),[q,L]=i.useState(0),O=i.useRef(t),P=i.useRef(l),w=i.useRef(o),C=i.useRef(x);i.useEffect(()=>{O.current=t,P.current=l,w.current=o,C.current=x,T(w.current,P.current,O.current,C.current)},[]);const T=(n,c,f,v)=>{console.log("Fetching Orders");const V=n+1;let S=`${se.baseURL}/api-proxy/proxy?method=get&resource=orders&page=${V}&page_size=${c}`;v&&(S+=`&name=${v}`),console.log(S),te.get(S,{headers:{Authorization:`Bearer ${ne.get("jwt")}`}}).then(g=>{console.log(g.data.data),u([...f,...g.data.data]),L(g.data.count)}).catch(g=>{console.error("Error fetching orders:",g)})},D=(n,c)=>{c!==""&&(p(b===c&&j==="asc"?"desc":"asc"),I(c))},H=(n,c)=>{h(c);const f=l*c;f>s&&(m(f),T(c,l,t,x))},z=n=>{h(0),B(parseInt(n.target.value,10))},W=n=>{$(n.target.value)},U=n=>{n.key==="Enter"&&_()},_=n=>{h(0),T(o,l,[],x)},M=(n,c)=>{a.push(`/orders/${c}`)},K=!t.length&&!!x;return e.jsxs(fe,{children:[e.jsx(re,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:e.jsx(R,{variant:"h4",children:"Orders"})}),e.jsxs(ge,{children:[e.jsx(F,{filterName:x,onFilterName:W,onClickSearch:_,onHitEnter:U}),e.jsx(ae,{children:e.jsx(de,{sx:{overflow:"unset"},children:e.jsxs(ue,{sx:{minWidth:800},children:[e.jsx(A,{order:j,orderBy:b,rowCount:t.length,onRequestSort:D,headLabel:[{id:"name",label:"Name"},{id:"customer",label:"Customer"},{id:"create_date",label:"Create Date"},{id:"amount_untaxed",label:"Amount Untaxed"},{id:"amount_tax",label:"Amount Tax"},{id:"amount_total",label:"Amount Total"},{id:"state",label:"State"}]}),e.jsxs(he,{children:[t.slice(o*l,o*l+l).map(n=>e.jsx(N,{name:n.name,customer:n.customer_id.name,create_date:n.create_date,amount_untaxed:n.amount_untaxed,amount_tax:n.amount_tax,amount_total:n.amount_total,state:n.state,handleClick:c=>M(c,n.id)},n.id)),e.jsx(E,{height:77,emptyRows:ye(o,l,t.length)}),K&&e.jsx(k,{query:x})]})]})})}),e.jsx(xe,{page:o,component:"div",count:q,rowsPerPage:l,onPageChange:H,rowsPerPageOptions:[25],onRowsPerPageChange:z})]})]})}function ke(){return je(),e.jsxs(e.Fragment,{children:[e.jsx(oe,{children:e.jsx("title",{children:" Order | BEX Sales "})}),e.jsx(Te,{})]})}export{ke as default};
