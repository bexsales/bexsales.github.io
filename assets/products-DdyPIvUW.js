import{j as e,N as V,T as _,P as t,B as X,O as J,I as Y,H as Z,Q as ee,r as c,E as te,F as ne,G as ae,S as se,R as re,W as oe}from"./index-CrQ_cH7N.js";import{T,a as u,b as ie,c as ce,d as le,e as de,f as ue,g as pe,h as he}from"./search-fill-Br6OXajf.js";import{C as xe}from"./Chip-BJvXCU4D.js";import{O as fe}from"./Select-3JCclZm4.js";import{C as ge}from"./Container-Bo6T3YIZ.js";import{C as me}from"./Card-xykPG5M7.js";import{u as be}from"./use-auth-Ts08gJbQ.js";const je={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function ye(s,r,o){return s?Math.max(0,(1+s)*r-o):0}function I({query:s}){return e.jsx(T,{children:e.jsx(u,{align:"center",colSpan:6,sx:{py:3},children:e.jsxs(V,{sx:{textAlign:"center"},children:[e.jsx(_,{variant:"h6",paragraph:!0,children:"Not found"}),e.jsxs(_,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',s,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}I.propTypes={query:t.string};function O({emptyRows:s,height:r}){return s?e.jsx(T,{sx:{...r&&{height:r*s}},children:e.jsx(u,{colSpan:9})}):null}O.propTypes={emptyRows:t.number,height:t.number};function $({id:s,default_code:r,name:o,category:h,type:i,lst_price:a,description_sale:x,attributes:m,virtual_available:b,qty_available:j,onSelect:y}){const P=d=>`$${d.toFixed(2)}`;return e.jsxs(T,{hover:!0,tabIndex:-1,onClick:()=>y({id:s,default_code:r,name:o,category:h,type:i,lst_price:a,description_sale:x,attributes:m,virtual_available:b,qty_available:j}),children:[e.jsx(u,{children:r}),e.jsx(u,{children:o}),e.jsx(u,{children:h}),e.jsx(u,{children:i}),e.jsx(u,{children:P(a)}),e.jsx(u,{children:x}),e.jsx(u,{children:m.map((d,S)=>e.jsx(xe,{label:d,variant:"outlined"},S))}),e.jsx(u,{children:j})]})}$.propTypes={id:t.any,default_code:t.any,name:t.any,category:t.any,type:t.any,lst_price:t.any,description_sale:t.any,attributes:t.arrayOf(t.string),virtual_available:t.any,qty_available:t.any,onSelect:t.func};function q({order:s,orderBy:r,headLabel:o,onRequestSort:h}){const i=a=>x=>{h(x,a)};return e.jsx(ie,{children:e.jsx(T,{children:o.map(a=>e.jsx(u,{align:a.align||"left",sortDirection:r===a.id?s:!1,sx:{width:a.width,minWidth:a.minWidth},children:e.jsxs(ce,{hideSortIcon:!0,active:r===a.id,direction:r===a.id?s:"desc",onClick:i(a.id),children:[a.label,r===a.id?e.jsx(X,{sx:{...je},children:s==="desc"?"sorted descending":"sorted ascending"}):null]})},a.id))})})}q.propTypes={order:t.oneOf(["asc","desc"]),orderBy:t.string,headLabel:t.array,onRequestSort:t.func};function A({filterName:s,onFilterName:r,onClickSearch:o,onHitEnter:h}){return e.jsx(J,{sx:{height:96,display:"flex",justifyContent:"space-between",p:i=>i.spacing(0,1,0,3)},children:e.jsx(fe,{value:s,onChange:r,onKeyDown:h,placeholder:"Search product...",endAdornment:e.jsx(Y,{position:"end",children:e.jsx(Z,{onClick:o,edge:"end",children:e.jsx(ee,{icon:le,sx:{color:"text.disabled",width:20,height:20}})})})})})}A.propTypes={filterName:t.string,onFilterName:t.func,onClickSearch:t.func,onHitEnter:t.func};function B({showTitle:s,onSelect:r}){const[o,h]=c.useState([]),[i,a]=c.useState(0),[x,m]=c.useState(0),[b,j]=c.useState("asc"),[y,P]=c.useState("name"),[d,S]=c.useState(""),[p,H]=c.useState(25),[D,L]=c.useState(0),w=c.useRef(o),C=c.useRef(p),N=c.useRef(i),E=c.useRef(d);c.useEffect(()=>{w.current=o,C.current=p,N.current=i,E.current=d,v(N.current,C.current,w.current,E.current)},[]);const v=(n,l,f,F)=>{console.log("Fetching Products");const K=n+1;let R=`${te.baseURL}/api-proxy/proxy?method=get&resource=products&page=${K}&page_size=${l}`;F&&(R+=`&name=${F}`),console.log(R),ne.get(R,{headers:{Authorization:`Bearer ${ae.get("jwt")}`}}).then(g=>{console.log(g.data.data),h([...f,...g.data.data]),L(g.data.count)}).catch(g=>{console.error("Error fetching products:",g)})},W=(n,l)=>{l!==""&&(j(y===l&&b==="asc"?"desc":"asc"),P(l))},z=(n,l)=>{a(l);const f=p*l;f>x&&(m(f),v(l,p,o,d))},M=n=>{a(0),H(parseInt(n.target.value,10))},Q=n=>{S(n.target.value)},U=n=>{n.key==="Enter"&&k()},k=n=>{a(0),v(i,p,[],d)},G=!o.length&&!!d;return e.jsxs(ge,{children:[s&&e.jsx(se,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:e.jsx(_,{variant:"h4",children:"Products"})}),e.jsxs(me,{children:[e.jsx(A,{filterName:d,onFilterName:Q,onClickSearch:k,onHitEnter:U}),e.jsx(re,{children:e.jsx(de,{sx:{overflow:"unset"},children:e.jsxs(ue,{sx:{minWidth:800},children:[e.jsx(q,{order:b,orderBy:y,rowCount:o.length,onRequestSort:W,headLabel:[{id:"default_code",label:"Default Code"},{id:"name",label:"Name"},{id:"category",label:"Category"},{id:"type",label:"Type"},{id:"lst_price",label:"Sale Price"},{id:"description_sale",label:"Description"},{id:"attributes",label:"Attributes"},{id:"qty_available",label:"Quantity on Hand"}]}),e.jsxs(pe,{children:[o.slice(i*p,i*p+p).map(n=>e.jsx($,{id:n.id,default_code:n.default_code,name:n.name,category:n.categ_id.name,type:n.type,lst_price:n.lst_price,description_sale:n.description_sale,attributes:n.product_template_attribute_value_ids.map(l=>`${l.attribute}:${l.name}`),virtual_available:n.virtual_available,qty_available:n.qty_available,onSelect:r},n.id)),e.jsx(O,{height:77,emptyRows:ye(i,p,o.length)}),G&&e.jsx(I,{query:d})]})]})})}),e.jsx(he,{page:i,component:"div",count:D,rowsPerPage:p,onPageChange:z,rowsPerPageOptions:[25],onRowsPerPageChange:M})]})]})}B.propTypes={showTitle:t.bool,onSelect:t.func};function Ce(){return be(),e.jsxs(e.Fragment,{children:[e.jsx(oe,{children:e.jsx("title",{children:" Products | BEX Sales "})}),e.jsx(B,{showTitle:!0})]})}export{Ce as default};
