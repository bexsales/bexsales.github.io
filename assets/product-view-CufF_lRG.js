import{j as e,H as X,T as w,P as t,B as Y,J as Z,I as ee,D as te,K as ne,r as i,y as ae,z as se,S as q,M as re,A as oe}from"./index-B8l5MPOb.js";import{T as P,a as l,b as ie,c as ce,s as le,d as de,e as ue,f as pe,g as he}from"./search-fill-BqqYaOZF.js";import{C as xe}from"./Chip-Dvl3wgkB.js";import{O as ge}from"./Select-CETdWe22.js";import{C as fe}from"./CircularProgress-j2gw31bc.js";import{C as me}from"./Container-57NIevnF.js";import{C as be}from"./Card-DExzLAxj.js";const ye={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function je(a,r,d){return a?Math.max(0,(1+a)*r-d):0}function A({query:a}){return e.jsx(P,{children:e.jsx(l,{align:"center",colSpan:6,sx:{py:3},children:e.jsxs(X,{sx:{textAlign:"center"},children:[e.jsx(w,{variant:"h6",paragraph:!0,children:"Not found"}),e.jsxs(w,{variant:"body2",children:["No results found for  ",e.jsxs("strong",{children:['"',a,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}A.propTypes={query:t.string};function O({emptyRows:a,height:r}){return a?e.jsx(P,{sx:{...r&&{height:r*a}},children:e.jsx(l,{colSpan:9})}):null}O.propTypes={emptyRows:t.number,height:t.number};function $({id:a,default_code:r,image:d,name:u,category:o,type:s,lst_price:c,description_sale:g,attributes:j,virtual_available:S,qty_available:f,onSelect:R}){const T=m=>`$${m.toFixed(2)}`;return e.jsxs(P,{hover:!0,tabIndex:-1,onClick:()=>R({id:a,default_code:r,image:d,name:u,category:o,type:s,lst_price:c,description_sale:g,attributes:j,virtual_available:S,qty_available:f}),children:[e.jsx(l,{children:r}),e.jsx(l,{children:d&&e.jsx("img",{src:`data:image/png;base64,${d}`,alt:u,style:{width:"100px",height:"100px"}})}),e.jsx(l,{children:u}),e.jsx(l,{children:o}),e.jsx(l,{children:s}),e.jsx(l,{children:T(c)}),e.jsx(l,{children:g}),e.jsx(l,{children:j.map((m,h)=>e.jsx(xe,{label:m.name,variant:"outlined"},h))}),e.jsx(l,{children:f})]})}$.propTypes={id:t.any,default_code:t.any,image:t.any,name:t.any,category:t.any,type:t.any,lst_price:t.any,description_sale:t.any,attributes:t.arrayOf(t.shape({name:t.string})),virtual_available:t.any,qty_available:t.any,onSelect:t.func};function D({order:a,orderBy:r,headLabel:d,onRequestSort:u}){const o=s=>c=>{u(c,s)};return e.jsx(ie,{children:e.jsx(P,{children:d.map(s=>e.jsx(l,{align:s.align||"left",sortDirection:r===s.id?a:!1,sx:{width:s.width,minWidth:s.minWidth},children:e.jsxs(ce,{hideSortIcon:!0,active:r===s.id,direction:r===s.id?a:"desc",onClick:o(s.id),children:[s.label,r===s.id?e.jsx(Y,{sx:{...ye},children:a==="desc"?"sorted descending":"sorted ascending"}):null]})},s.id))})})}D.propTypes={order:t.oneOf(["asc","desc"]),orderBy:t.string,headLabel:t.array,onRequestSort:t.func};function H({filterName:a,onFilterName:r,onClickSearch:d,onHitEnter:u}){return e.jsx(Z,{sx:{height:96,display:"flex",justifyContent:"space-between",p:o=>o.spacing(0,1,0,3)},children:e.jsx(ge,{value:a,onChange:r,onKeyDown:u,placeholder:"Search product...",endAdornment:e.jsx(ee,{position:"end",children:e.jsx(te,{onClick:d,edge:"end",children:e.jsx(ne,{icon:le,sx:{color:"text.disabled",width:20,height:20}})})})})})}H.propTypes={filterName:t.string,onFilterName:t.func,onClickSearch:t.func,onHitEnter:t.func};function Te({showTitle:a,onSelect:r}){const[d,u]=i.useState(!1),[o,s]=i.useState([]),[c,g]=i.useState(0),[j,S]=i.useState(0),[f,R]=i.useState("asc"),[T,m]=i.useState("name"),[h,B]=i.useState(""),[p,z]=i.useState(25),[L,M]=i.useState(0),C=i.useRef(o),N=i.useRef(p),I=i.useRef(c),k=i.useRef(h);i.useEffect(()=>{C.current=o,N.current=p,I.current=c,k.current=h,_(I.current,N.current,C.current,k.current)},[]);const _=(n,x,b,F)=>{console.log("Fetching Products"),u(!0);const G=n+1;let v=`${oe.baseURL}/api-proxy/proxy?method=get&resource=products&page=${G}&page_size=${x}`;F&&(v+=`&name=${F}`),v+="&include_images=true",console.log(v),ae.get(v,{headers:{Authorization:`Bearer ${se.get("jwt")}`}}).then(y=>{console.log(y.data.data),s([...b,...y.data.data]),M(y.data.count)}).catch(y=>{console.error("Error fetching products:",y)}).finally(()=>{u(!1)})},W=(n,x)=>{x!==""&&(R(T===x&&f==="asc"?"desc":"asc"),m(x))},K=(n,x)=>{g(x);const b=p*x;window.scrollTo({top:0,behavior:"smooth"}),b>j&&(S(b),_(x,p,o,h))},U=n=>{g(0),z(parseInt(n.target.value,10))},J=n=>{B(n.target.value)},Q=n=>{n.key==="Enter"&&E()},E=n=>{g(0),_(c,p,[],h)},V=!o.length&&!!h;return e.jsxs(e.Fragment,{children:[d&&e.jsx(q,{sx:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",bgcolor:"rgba(255, 255, 255, 0.6)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(fe,{})}),e.jsxs(me,{children:[a&&e.jsx(q,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:e.jsx(w,{variant:"h4",children:"Products"})}),e.jsxs(be,{children:[e.jsx(H,{filterName:h,onFilterName:J,onClickSearch:E,onHitEnter:Q}),e.jsx(re,{children:e.jsx(de,{sx:{overflow:"unset"},children:e.jsxs(ue,{sx:{minWidth:800},children:[e.jsx(D,{order:f,orderBy:T,rowCount:o.length,onRequestSort:W,headLabel:[{id:"default_code",label:"Default Code"},{id:"image",label:" ".repeat(30)},{id:"name",label:"Name"},{id:"category",label:"Category"},{id:"type",label:"Type"},{id:"lst_price",label:"Sale Price"},{id:"description_sale",label:"Description"},{id:"attributes",label:"Attributes"},{id:"qty_available",label:"Quantity on Hand"}]}),e.jsxs(pe,{children:[o.slice(c*p,c*p+p).map(n=>e.jsx($,{id:n.id,default_code:n.default_code,image:n.image,name:n.name,category:n.categ_id.name,type:n.type,lst_price:n.lst_price,description_sale:n.description_sale,attributes:n.product_template_attribute_value_ids,virtual_available:n.virtual_available,qty_available:n.qty_available,onSelect:r},n.id)),e.jsx(O,{height:77,emptyRows:je(c,p,o.length)}),V&&e.jsx(A,{query:h})]})]})})}),e.jsx(he,{page:c,component:"div",count:L,rowsPerPage:p,onPageChange:K,rowsPerPageOptions:[25],onRowsPerPageChange:U})]})]})]})}Te.propTypes={showTitle:t.bool,onSelect:t.func};export{Te as P};
